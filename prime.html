<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Credenciales Amazon Prime</title>
  <style>
    :root {
      --bg:#f4f6fb;
      --card:#fff;
      --accent:#1a73e8;
      --accent-dark:#1558b0;
      --muted:#6b7280;
      --pill:#f9fafb;
      --warning-bg:#e8f0fe;
      --warning-border:#1a73e8;
      --warning-text:#0d3c80;
      --success:#16a34a;
    }
    *{box-sizing:border-box}
    body {
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:var(--bg);
      background: url("https://media.es.wired.com/photos/65cbe59aaf248cc99f8f4f6a/16:9/w_2560%2Cc_limit/Series%2520de%2520Prime%2520Video.jpeg") no-repeat center center fixed;
      background-size: cover;
      font-family:Inter, system-ui, sans-serif;
      color:#111827;
      padding:20px;
    }
    .card {
      max-width:460px;
      width:100%;
      background:var(--card);
      border-radius:16px;
      box-shadow:0 8px 30px rgba(0,0,0,0.08);
      padding:24px;
    }
    .brand { text-align:center; margin-bottom:20px; }
    .brand h1 { font-size:20px; margin:8px 0 0; color:#111827; }
    .fila { margin-bottom:14px; }
    .etiqueta { font-size:13px; font-weight:600; color:var(--muted); margin-bottom:6px; }
    .valor { display:flex; align-items:center; gap:8px; }
    .block {
      background:var(--pill);
      padding:10px 12px;
      border-radius:8px;
      font-weight:600;
      flex:1;
      word-break:break-all;
      font-size:14px;
      user-select:text;
    }
    .btn {
      background:var(--accent);
      color:#fff;
      border:0;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      font-size:13px;
      font-weight:600;
      transition:.2s;
    }
    .btn:hover {background:var(--accent-dark);}
    .rules {
      background:var(--warning-bg);
      border-left:6px solid var(--warning-border);
      color:var(--warning-text);
      padding:14px;
      border-radius:12px;
      font-size:14px;
      margin-top:20px;
      line-height:1.5;
    }
    .rules strong { display:block; margin-bottom:6px; font-size:15px; color:var(--accent-dark); }
    .toast {
      position:fixed; right:20px; bottom:20px;
      background:#111827; color:white; padding:10px 14px; border-radius:10px;
      opacity:0; transform:translateY(12px); transition:all .28s ease;
      font-size:14px; display:flex; gap:8px; align-items:center; z-index:1000;
    }
    .toast.show {opacity:1; transform:translateY(0);}
    .toast .dot { width:10px; height:10px; border-radius:50%; background:var(--success); }
  </style>
</head>
<body>
  <div class="card">
    <div class="brand">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/f1/Prime_Video.png" alt="Amazon Prime" width="120">
      <h1>Credenciales Amazon Prime</h1>
    </div>

    <div class="fila">
      <div class="etiqueta">üìß Correo</div>
      <div class="valor">
        <div id="correo" class="block">Cargando...</div>
        <button class="btn" data-copy="correo">Copiar</button>
      </div>
    </div>

    <div class="fila">
      <div class="etiqueta">üîë Contrase√±a</div>
      <div class="valor">
        <div id="clave" class="block">Cargando...</div>
        <button class="btn" data-copy="clave">Copiar</button>
      </div>
    </div>

    <div class="fila">
      <div class="etiqueta">üë§ Perfil</div>
      <div class="valor">
        <div id="perfil" class="block">Cargando...</div>
      </div>
    </div>

    <div class="fila">
      <div class="etiqueta">üìå PIN</div>
      <div class="valor">
        <div id="pin" class="block">Cargando...</div>
      </div>
    </div>

    <div class="rules">
      <strong>‚ö†Ô∏è Normas de uso ‚ö†Ô∏è</strong>
      <ul>
        <li>üì± Recordar: <b>1 pantalla = 1 dispositivo m√°ximo</b></li>
        <li>üîí No modificar la contrase√±a</li>
        <li>üö´ De lo contrario, se perder√° garant√≠a y ser√° expulsado</li>
      </ul>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">
    <span class="dot" aria-hidden="true"></span>
    <span id="toastText">Copiado al portapapeles</span>
  </div>

  <script>
  (function() {
    const buttons = document.querySelectorAll('[data-copy]');
    const toast = document.getElementById('toast');
    const toastText = document.getElementById('toastText');
    let toastTimer = null;

    // === URL de tu Google Sheet convertida a JSON (OpenSheet) ===
    const DATA_URL = "https://opensheet.elk.sh/1ToAIEzD0lvLHf9NTt4YaUS-U3Fr5ux8-175oLa0c2SI/1";

    // Mostrar toast
    function showToast(text) {
      toastText.textContent = text;
      toast.classList.add('show');
      if (toastTimer) clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toast.classList.remove('show'), 2000);
    }

    // Copiar texto del elemento por id
    async function copyText(id) {
      const el = document.getElementById(id);
      if (!el) return;
      const text = el.innerText.trim();
      try {
        await navigator.clipboard.writeText(text);
        showToast("Copiado: " + text);
      } catch (e) {
        // fallback: selecci√≥n manual
        showToast("No se pudo copiar autom√°ticamente. Selecciona y copia.");
      }
    }

    // Asignar evento a botones copiar
    buttons.forEach(btn => {
      btn.addEventListener("click", () => copyText(btn.getAttribute("data-copy")));
    });

    // Normaliza claves: quita tildes, espacios y caracteres no alfanum√©ricos, pasa a min√∫sculas
    function normalizeKey(k) {
      if (!k) return "";
      return k
        .toString()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "") // quita tildes
        .toLowerCase()
        .replace(/[^a-z0-9]/g, ""); // deja solo letras y n√∫meros
    }

    // Mapea objeto cuenta con claves normalizadas
    function normalizeObjectKeys(obj) {
      const map = {};
      for (const key in obj) {
        if (!Object.prototype.hasOwnProperty.call(obj, key)) continue;
        map[normalizeKey(key)] = obj[key];
      }
      return map;
    }

    // Devuelve el primer valor existente de la lista de candidatos en el map
    function getFirst(map, candidates) {
      for (const c of candidates) {
        if (map[c] !== undefined && map[c] !== null && String(map[c]).trim() !== "") {
          return String(map[c]).trim();
        }
      }
      return "";
    }

    // Cargar datos desde la hoja (usa la √∫ltima fila por defecto)
    async function loadData() {
      try {
        const res = await fetch(DATA_URL);
        const data = await res.json();

        if (!Array.isArray(data) || data.length === 0) {
          showToast("No hay datos en la hoja (JSON vac√≠o).");
          return;
        }

        // usamos la √∫ltima fila (√∫ltimo registro). Si prefieres la primera, usa data[0].
        const rawCuenta = data[data.length - 1];
        const cuentaMap = normalizeObjectKeys(rawCuenta);

        // intenta varios nombres posibles (sin tilde, en min√∫sculas)
        const correo = getFirst(cuentaMap, ["correo", "email", "e-mail", "correoelectronico"]);
        const clave  = getFirst(cuentaMap, ["contrasena", "contrasenia", "contrase√±a", "clave", "password", "pass"]);
        const perfil = getFirst(cuentaMap, ["perfil", "profile", "usuario"]);
        const pin    = getFirst(cuentaMap, ["pin", "codigo", "codigo_pin", "ping"]);

        document.getElementById("correo").textContent = correo || "No disponible";
        document.getElementById("clave").textContent  = clave  || "No disponible";
        document.getElementById("perfil").textContent = perfil || "-";
        document.getElementById("pin").textContent    = pin    || "-";

        // Debug en consola (puedes quitar luego)
        console.debug("Registro usado (normalizado):", cuentaMap);
      } catch (err) {
        console.error("Error cargando datos:", err);
        showToast("Error cargando datos (ver consola).");
      }
    }

    // Ejecutar al inicio
    document.addEventListener("DOMContentLoaded", loadData);
  })();
  </script>
</body>
</html>
